<div class="py-4 px-0" id="material-view">
  <div class="container">
    <ng-container *ngIf="collection">
      <div class="row mb-4">
        <!--@todo: col-lg-6 with actions-->
        <div class="col-lg-12">
          <h1>{{ collection.collection.name }}</h1>
        </div>

        <!--@todo: add actions-->
        <!--<div class="col-lg-6 text-lg-right">
          muokkaa / poista / lataa
        </div>-->
      </div>

      <ng-container *ngIf="collection.educationalmaterials.length > 0; else noMaterials">
        <div class="collection-material border-top" *ngFor="let collectionMaterial of collection.educationalmaterials; let i = index">
          <h2>
            <a [routerLink]="['/materiaali', collectionMaterial.id]">
              {{ collectionMaterial.name[lang] }}
            </a>
          </h2>

          <ul class="list-unstyled authors">
            <li *ngFor="let author of collectionMaterial.author">
              <ng-container *ngIf="author.authorname !== ''; else organizationAuthor">
                {{ author.authorname }}
                <ng-container *ngIf="author.organization">({{ author.organization }})</ng-container>
              </ng-container>

              <ng-template #organizationAuthor>
                {{ author.organization }}
              </ng-template>
            </li>
          </ul>

          <div *ngIf="materialsLoading.get(collectionMaterial.id) === false; else loading">
            <div class="list-files mb-4" *ngIf="collectionMaterials.get(collectionMaterial.id).length > 0">
              <div class="row no-gutters">
                <div class="col-3">
                  <div class="btn-group mb-2" role="group" *ngIf="materialLanguages.get(collectionMaterial.id).length > 1">
                    <button
                      type="button"
                      class="btn btn-gray"
                      *ngFor="let lang of materialLanguages.get(collectionMaterial.id)"
                      (click)="setSelectedLanguage(collectionMaterial.id, lang)"
                      [ngClass]="lang === selectedLanguages.get(collectionMaterial.id) ? 'active' : ''"
                    >{{ lang }}</button>
                  </div>

                  <div class="btn-group-vertical" role="group">
                    <ng-container *ngFor="let material of collectionMaterials.get(collectionMaterial.id)">
                      <button
                        type="button"
                        class="btn btn-file text-dark"
                        [ngClass]="material === previewMaterials.get(collectionMaterial.id) ? 'active' : ''"
                        (click)="setPreviewMaterial(collectionMaterial.id, material)"
                        *ngIf="material.language === selectedLanguages.get(collectionMaterial.id)"
                      >{{ material.displayName[lang] }}</button>
                    </ng-container>
                  </div>
                </div>

                <div class="col-9">
                  <app-educational-material-preview
                    [material]="previewMaterials.get(collectionMaterial.id)"
                    [isCollection]="true"
                    *ngIf="!previewMaterials.get(collectionMaterial.id).link"></app-educational-material-preview>

                  <a
                    *ngIf="previewMaterials.get(collectionMaterial.id).link"
                    [href]="previewMaterials.get(collectionMaterial.id).link"
                    class="btn btn-secondary"
                    target="_blank"
                    rel="noopener nofollow"
                  >{{ 'demo.educationalMaterial.preview.openInNewTab' | translate }}</a>
                </div>
              </div>
            </div>
          </div>

          <ng-template #loading>
            <div class="spinner-border" role="status">
              <span class="sr-only">{{ 'collections.loading' | translate }}</span>
            </div>
          </ng-template>
        </div>
      </ng-container>

      <ng-template #noMaterials>
        {{ 'collections.noMaterials' | translate }}
      </ng-template>
    </ng-container>
  </div>
</div>
