<div class="collection-resource-preview">
  <div *ngIf="isLoading === false; else loading">
    <div class="list-files mb-4" *ngIf="materials.length > 0">
      <div class="row no-gutters">
        <div class="col-3">
          <ng-container *ngIf="languages.length > 1">
            <h3
              [id]="'selectLanguage' + resourceId"
            >{{ 'materialPreview.selectLanguage' | translate }}</h3>

            <div class="btn-group mb-3" role="group" [attr.aria-labelledby]="'selectLanguage' + resourceId">
              <button
                type="button"
                class="btn btn-gray"
                *ngFor="let lang of languages"
                [ngClass]="lang === selectedLanguage ? 'active' : ''"
                [attr.aria-selected]="lang === selectedLanguage"
                [attr.aria-controls]="'fileList-' + resourceId + '-' + lang"
                [id]="'langSelector-' + resourceId + '-' + lang"
                role="tab"
                (click)="setSelectedLanguage(lang)"
              >{{ lang }}</button>
            </div>
          </ng-container>

          <div
            *ngIf="materials | materialLanguage:selectedLanguage as filteredMaterials"
            [id]="'fileList-' + selectedLanguage"
            role="tabpanel"
            [attr.aria-labelledby]="'langSelector-' + selectedLanguage"
          >
            <h3 id="selectMaterial" [ngClass]="filteredMaterials.length === 1 ? 'sr-only' : ''">
              {{ 'materialPreview.selectMaterial' | translate }}
            </h3>

            <div class="btn-group-vertical" role="group" aria-labelledby="selectMaterial">
              <ng-container *ngFor="let material of filteredMaterials">
                <button
                  type="button"
                  class="btn btn-file text-dark"
                  [ngClass]="material === previewMaterial ? 'active' : ''"
                  [attr.aria-selected]="material === previewMaterial"
                  [attr.aria-controls]="'filePreview-' + material.id"
                  [id]="'fileSelector-' + material.id"
                  role="tab"
                  (click)="setPreviewMaterial(material)"
                >{{ material.displayName[lang] }}</button>
              </ng-container>
            </div>
          </div>
        </div>

        <div class="col-9">
          <div
            [id]="'filePreview-' + resourceId + '-' + previewMaterial.id"
            role="tabpanel"
            [attr.aria-labelledby]="'fileSelector-' + resourceId + '-' + previewMaterial.id"
          >
            <app-educational-material-preview
              [material]="previewMaterial"
              *ngIf="!previewMaterial.link; else linkPreview"></app-educational-material-preview>

            <ng-template #linkPreview>
              <div class="link-preview">
                <a
                  [href]="previewMaterial.link"
                  class="btn btn-secondary"
                  target="_blank"
                  rel="noopener nofollow"
                >{{ 'demo.educationalMaterial.preview.openInNewTab' | translate }}</a>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-template #loading>
    <div class="loading">
      <div class="spinner-border" role="status">
        <span class="sr-only">{{ 'collections.loading' | translate }}</span>
      </div>
    </div>
  </ng-template><!--loading-->
</div>
